<div class="container">

  <div id="fanhua" class="form-horizontal">

    <div id="config">

      <form name="queryForm" novalidate>
      <div class="row">
        <div class="col-sm-4">
          <div class="form-group">
            <label for="CityCode" class="col-sm-5 control-label">投保城市 <span class="lcb-red">*</span></label>
            <div class="col-sm-7">
              <select id="CityCode" ng-model="ctrl.query.insureAreaCode" class="form-control" required>
                <option value="">请选择投保城市</option>
                <optgroup label="{{p.provinceName}}" ng-repeat="p in ctrl.supportCities.agreementAreas">
                  <option value="{{c.city}}" ng-repeat="c in p.citys">
                    {{c.cityName}}
                  </option>
                </optgroup>
              </select>
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="LicenseNo" class="col-sm-5 control-label">车牌号 <span class="lcb-red">*</span></label>
            <div class="col-sm-7">
              <input id="LicenseNo" ng-model="ctrl.query.carLicenseNo" type="text" class="form-control" placeholder="车牌号" required>
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="CarOwnersName" class="col-sm-5 control-label">车主姓名 <span class="lcb-red">*</span></label>
            <div class="col-sm-7">
              <input id="CarOwnersName" ng-model="ctrl.query.name" type="text" class="form-control" placeholder="车主姓名" required>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-4">
          <div class="form-group">
            <label for="MoldName" class="col-sm-5 control-label">车型</label>
            <div class="col-sm-7">
              <input id="MoldName" ng-model="ctrl.query.vehicleName" type="text" class="form-control" placeholder="车型">
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="EngineNo" class="col-sm-5 control-label">发动机号</label>
            <div class="col-sm-7">
              <input id="EngineNo" ng-model="ctrl.query.engineNo" type="text" class="form-control" placeholder="发动机号">
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="IdCard" class="col-sm-5 control-label">车主身份证号</label>
            <div class="col-sm-7">
              <input id="IdCard" ng-model="ctrl.query.idcardNo" type="text" class="form-control" placeholder="车主身份证号">
            </div>
          </div>
        </div>
      </div>
      </form>

      <form name="quoteForm" novalidate>
      <div class="row">
        <div class="col-sm-4">
          <div class="form-group">
            <label for="CarVin" class="col-sm-5 control-label">车架号</label>
            <div class="col-sm-7">
              <input id="CarVin" ng-model="ctrl.query.vinCode" type="text" class="form-control" placeholder="车驾号">
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="InsuredMobile" class="col-sm-5 control-label">手机号</label>
            <div class="col-sm-7">
              <input id="InsuredMobile" ng-model="ctrl.query.phone" type="text" class="form-control" placeholder="手机号">
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <button class="btn btn-primary pull-right" ng-disabled="queryForm.$invalid" ng-click="ctrl.fetchInfo()">加载信息</button>
          <button class="btn btn-default pull-right" style="margin-right: 5px;" ng-click="ctrl.reload()">重新报价</button>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-8">
          <div class="form-group">
            <label for="CarModel" class="col-sm-2 control-label">车型ID</label>
            <div class="col-sm-10">
              <select id="CarModel" ng-model="ctrl.query.vehicleId" ng-options="m.vehicleId as m.vehicleName for m in ctrl.carModels" class="form-control move-right" required>
              </select>
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <button class="btn btn-default" ng-click="ctrl.searchVehicle()">查找车型</button>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-4">
          <div class="form-group">
            <label for="IsLastYearNewCar" class="col-sm-5 control-label">是否未上牌</label>
            <div class="col-sm-7">
              <select id="IsLastYearNewCar" ng-model="ctrl.query.isNew" class="form-control">
                <option value="Y">未上牌</option>
                <option value="N">已上牌</option>
              </select>
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="RegisterDate" class="col-sm-5 control-label">初登日期</label>
            <div class="col-sm-7">
              <input id="RegisterDate" ng-model="ctrl.query.registDate" datetime="yyyy-MM-dd" datetime-model="yyyy-MM-dd" type="text" class="form-control" placeholder="注册日期">
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="IdCard" class="col-sm-5 control-label">发票价</label>
            <div class="col-sm-7">
              <input id="Price" ng-model="ctrl.query.price" type="text" class="form-control" placeholder="新车发票价">
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-4">
          <div class="form-group">
            <label for="IsLastYearNewCar" class="col-sm-5 control-label">是否过户车</label>
            <div class="col-sm-7">
              <select id="IsTransferCar" ng-model="ctrl.query.isTransferCar" class="form-control">
                <option value="Y">是</option>
                <option value="N">否</option>
              </select>
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="RegisterDate" class="col-sm-5 control-label">过户日期</label>
            <div class="col-sm-7">
              <input id="TransferDate" ng-model="ctrl.query.transferDate" datetime="yyyy-MM-dd" datetime-model="yyyy-MM-dd" type="text" class="form-control" placeholder="过户日期">
            </div>
          </div>
        </div>
        <div class="col-sm-4"></div>
      </div>

      <div class="row">
        <div class="col-sm-4">
          <div class="form-group">
            <label for="BizStartDate" class="col-sm-5 control-label">商业险起保日期</label>
            <div class="col-sm-7">
              <input id="BizStartDate" ng-model="ctrl.query.bizInsureInfo.startDate" datetime="yyyy-MM-dd" datetime-model="yyyy-MM-dd" type="text" class="form-control" placeholder="商业险起保日期">
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="BizEndDate" class="col-sm-5 control-label">商业险终保日期</label>
            <div class="col-sm-7">
              <input id="BizEndDate" ng-model="ctrl.query.bizInsureInfo.endDate" datetime="yyyy-MM-dd" datetime-model="yyyy-MM-dd" type="text" class="form-control" placeholder="商业险终保日期">
            </div>
          </div>
        </div>
        <div class="col-sm-4"></div>
      </div>

      <div class="row">
        <div class="col-sm-4">
          <div class="form-group">
            <label for="EfcStartDate" class="col-sm-5 control-label">交强险起保日期</label>
            <div class="col-sm-7">
              <input id="EfcStartDate" ng-model="ctrl.query.efcInsureInfo.startDate" datetime="yyyy-MM-dd" datetime-model="yyyy-MM-dd" type="text" class="form-control" placeholder="交强险起保日期">
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <label for="EfcEndDate" class="col-sm-5 control-label">交强险终保日期</label>
            <div class="col-sm-7">
              <input id="EfcEndDate" ng-model="ctrl.query.efcInsureInfo.endDate" datetime="yyyy-MM-dd" datetime-model="yyyy-MM-dd" type="text" class="form-control" placeholder="交强险终保日期">
            </div>
          </div>
        </div>
        <div class="col-sm-4">

        </div>
      </div>

      <div id="providers" class="row">
        <div class="col-sm-2">
          <div class="form-group"><label class="col-sm-10 control-label">保险公司</label></div>
        </div>
        <div class="col-sm-10">
          <label ng-repeat="p in ctrl.providers">
            <input type="checkbox" checklist-model="ctrl.providers" checklist-value="p"> {{p.prvName}}
          </label>
        </div>
      </div>

      </form>

    </div>

    <div id="selection" class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title pull-left">保险配置 <span ng-if="ctrl.taskId">（任务号：{{ctrl.taskId}}）</span></h3>
        <button class="btn btn-primary pull-right" type="button" ng-click="ctrl.loadLastResult()" style="margin-left: 5px;">上次报价</button>
        <button class="btn btn-primary pull-right" type="button" ng-click="ctrl.createQuote()" ng-disabled="quoteForm.$invalid || ctrl.cantQuote()" style="margin-left: 5px;">标准报价</button>
        <button class="btn btn-primary pull-right" type="button" ng-click="ctrl.quickQuote()" ng-disabled="quoteForm.$invalid || ctrl.cantQuote()">简易报价</button>
        <div class="clearfix"></div>
      </div>
      <div class="panel-body">

        <table class="table table-bordered">
          <thead>
            <tr class="text-nowrap">
              <th>险种</th>
              <th></th>
              <th>不记免赔</th>
              <th ng-repeat="(supplier, value) in ctrl.result">{{value.prvName}}</th>
            </tr>
            <tr class="lcb-summary">
              <td>状态</td>
              <td></td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><strong>{{value.taskStateDescription}}</strong><br/>{{value.msg}}</td>
            </tr>
            <tr class="lcb-summary">
              <td>操作</td>
              <td></td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result" class="text-center">
                <button class="btn btn-default" ng-if="value.taskState == 3" ng-click="ctrl.pay(value)">付款</button>
                <button class="btn btn-default" ng-if="value.taskState == 5" ng-click="ctrl.submitInsure(value)">核保</button>
                <button class="btn btn-default" ng-if="value.taskState == 5 || value.taskState == 19" ng-click="ctrl.reimbursement(value)">退款</button>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>交强险</td>
              <td><input id="CompulsoryTax" ng-model="ctrl.query.efcInsure" type="checkbox"></td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.efcInsureInfo"></lcb-json-table></td>
            </tr>
            <tr>
              <td>车船税</td>
              <td><input id="VehicleTax" ng-model="ctrl.query.taxInsure" type="checkbox"></td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.taxInsureInfo"></lcb-json-table></td>
            </tr>
            <tr class="lcb-summary">
              <td>商业险合计</td>
              <td></td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result">{{value.insureInfo.bizInsureInfo.premium}}</td>
            </tr>
            <tr class="lcb-summary">
              <td>商业险不计免赔合计</td>
              <td></td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result">{{value.insureInfo.bizInsureInfo.nfcPremium}}</td>
            </tr>
            <tr class="lcb-summary">
              <td>商业险折扣率</td>
              <td></td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result">{{value.insureInfo.bizInsureInfo.discountRate}}</td>
            </tr>
            <tr class="lcb-summary">
              <td>商业险起保日期</td>
              <td></td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result">{{value.insureInfo.bizInsureInfo.startDate}}</td>
            </tr>
            <tr class="lcb-summary">
              <td>商业险终保日期</td>
              <td></td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result">{{value.insureInfo.bizInsureInfo.endDate}}</td>
            </tr>
            <tr>
              <td>机动车损失险</td>
              <td><input id="CheSun" ng-model="ctrl.quote['VehicleDemageIns'].amount" type="checkbox" ng-true-value="1" ng-false-value="0"></td>
              <td><input id="BuJiMianCheSun" ng-model="ctrl.quote['VehicleDemageIns'].notDeductible" type="checkbox" ng-true-value="'Y'" ng-false-value="'N'"></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.VehicleDemageIns"></lcb-json-table></td>
            </tr>
            <!--tr>
              <td>机动车损失无法找到第三方特约险</td>
              <td>
                <input id="HcSanFangTeYue" ng-model="ctrl.quote.HcSanFangTeYue" type="checkbox" ng-true-value="1" ng-false-value="0">
              </td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.HcSanFangTeYue"></lcb-json-table></td>
            </tr-->
            <tr>
              <td>第三者责任险</td>
              <td>
                <select id="SanZhe" ng-model="ctrl.quote['ThirdPartyIns'].amount" class="form-control">
                  <option value="0">不投保</option>
                  <option>100000</option>
                  <option>200000</option>
                  <option>300000</option>
                  <option>500000</option>
                  <option>1000000</option>
                  <option>2000000</option>
                </select>
              </td>
              <td><input id="BuJiMianSanZhe" ng-model="ctrl.quote['ThirdPartyIns'].notDeductible" type="checkbox" ng-true-value="'Y'" ng-false-value="'N'"></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.ThirdPartyIns"></lcb-json-table></td>
            </tr>
            <tr>
              <td>司机险</td>
              <td>
                <select id="SiJi" ng-model="ctrl.quote['DriverIns'].amount" class="form-control">
                  <option value="0">不投保</option>
                  <option>10000</option>
                  <option>20000</option>
                  <option>30000</option>
                  <option>50000</option>
                  <option>100000</option>
                  <option>200000</option>
                </select>
              </td>
              <td><input id="BuJiMianSiJi" ng-model="ctrl.quote['DriverIns'].notDeductible" type="checkbox" ng-true-value="'Y'" ng-false-value="'N'"></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.DriverIns"></lcb-json-table></td>
            </tr>
            <tr>
              <td>乘客险</td>
              <td>
                <select id="ChengKe" ng-model="ctrl.quote['PassengerIns'].amount" class="form-control">
                  <option value="0">不投保</option>
                  <option>10000</option>
                  <option>20000</option>
                  <option>30000</option>
                  <option>50000</option>
                  <option>100000</option>
                  <option>200000</option>
                </select>
              </td>
              <td><input id="BuJiMianChengKe" ng-model="ctrl.quote['PassengerIns'].notDeductible" type="checkbox" ng-true-value="'Y'" ng-false-value="'N'"></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.PassengerIns"></lcb-json-table></td>
            </tr>
            <tr>
              <td>盗抢险</td>
              <td><input id="DaoQiang" ng-model="ctrl.quote['TheftIns'].amount" type="checkbox" ng-true-value="1" ng-false-value="0"></td>
              <td><input id="BuJiMianDaoQiang" ng-model="ctrl.quote['TheftIns'].notDeductible" type="checkbox" ng-true-value="'Y'" ng-false-value="'N'"></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.TheftIns"></lcb-json-table></td>
            </tr>
            <tr>
              <td>玻璃险</td>
              <td>
                <select id="BoLi" ng-model="ctrl.quote['GlassIns'].amount" class="form-control">
                  <option value="0">不投保</option>
                  <option value="1">国产玻璃</option>
                  <option value="2">进口玻璃</option>
                </select>
              </td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.GlassIns"></lcb-json-table></td>
            </tr>
            <tr>
              <td>自燃险</td>
              <td><input id="ZiRan" ng-model="ctrl.quote['CombustionIns'].amount" type="checkbox" ng-true-value="1" ng-false-value="0"></td>
              <td><input id="BuJiMianZiRan" ng-model="ctrl.quote['CombustionIns'].notDeductible" type="checkbox" ng-true-value="'Y'" ng-false-value="'N'"></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.CombustionIns"></lcb-json-table></td>
            </tr>
            <tr>
              <td>划痕险</td>
              <td>
                <select id="HuaHen" ng-model="ctrl.quote['ScratchIns'].amount" class="form-control">
                  <option value="0">不投保</option>
                  <option>2000</option>
                  <option>5000</option>
                  <option>10000</option>
                  <option>20000</option>
                </select>
              </td>
              <td><input id="BuJiMianHuaHen" ng-model="ctrl.quote['ScratchIns'].notDeductible" type="checkbox" ng-true-value="'Y'" ng-false-value="'N'"></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.ScratchIns"></lcb-json-table></td>
            </tr>
            <tr>
              <td>涉水险</td>
              <td><input id="SheShui" ng-model="ctrl.quote['WadingIns'].amount" type="checkbox" ng-true-value="1" ng-false-value="0"></td>
              <td><input id="BuJiMianSheShui" ng-model="ctrl.quote['WadingIns'].notDeductible" type="checkbox" ng-true-value="'Y'" ng-false-value="'N'"></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.WadingIns"></lcb-json-table></td>
            </tr>
            <tr>
              <td>机动车损失无法找到第三方特约险</td>
              <td>
                <input id="HcSanFangTeYue" ng-model="ctrl.quote['VehicleDemageMissedThirdPartyCla'].amount" type="checkbox" ng-true-value="1" ng-false-value="0">
              </td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.VehicleDemageMissedThirdPartyCla"></lcb-json-table></td>
            </tr>
            <tr>
              <td>指定修理厂险</td>
              <td><input id="HcXiuLiChang" ng-model="ctrl.quote['SpecifyingPlantCla'].amount" type="checkbox" ng-true-value="1" ng-false-value="0"></td>
              <td></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.SpecifyingPlantCla"></lcb-json-table></td>
            </tr>
            <tr>
              <td>车上货物责任险</td>
              <td>
                <select id="GoodsOnVehicleIns" ng-model="ctrl.quote['GoodsOnVehicleIns'].amount" class="form-control">
                  <option value="0">不投保</option>
                  <option>10000</option>
                  <option>20000</option>
                  <option>50000</option>
                  <option>100000</option>
                  <option>200000</option>
                </select>
              </td>
              <td><input id="BuJiMianGoodsOnVehicleIns" ng-model="ctrl.quote['GoodsOnVehicleIns'].notDeductible" type="checkbox" ng-true-value="'Y'" ng-false-value="'N'"></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.GoodsOnVehicleIns"></lcb-json-table></td>
            </tr>
            <tr>
              <td>精神损害抚慰金</td>
              <td>
                <select id="HcJingShenSunShi" ng-model="ctrl.quote['CompensationForMentalDistressIns'].amount" class="form-control">
                  <option value="0">不投保</option>
                  <option>10000</option>
                  <option>20000</option>
                  <option>30000</option>
                  <option>40000</option>
                  <option>50000</option>
                </select>
              </td>
              <td><input id="BuJiMianHcJingShenSunShi" ng-model="ctrl.quote['CompensationForMentalDistressIns'].notDeductible" type="checkbox" ng-true-value="'Y'" ng-false-value="'N'"></td>
              <td ng-repeat="(supplier, value) in ctrl.result"><lcb-json-table json="value.insureInfo.bizInsureInfo.riskKinds.CompensationForMentalDistressIns"></lcb-json-table></td>
            </tr>
          </tbody>
        </table>

      </div>
    </div>

  </div>

  <div id="info" class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">续保信息</h3>
    </div>
    <div class="panel-body">
      <pre pretty-json="ctrl.info"></pre>
    </div>
  </div>

  <div id="result" class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">报价结果</h3>
    </div>
    <div class="panel-body">
      <pre pretty-json="ctrl.result"></pre>
    </div>
  </div>

</div>